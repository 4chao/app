var e=Object.defineProperty,t=(t,a)=>e(t,"name",{value:a,configurable:!0});import{a,j as l,R as i,l as u,k as n,_ as o,g as s,o as d,e as r,T as v,D as c,c as m,w as p,L as f,p as x,s as h,z as g,A as y,F as b,m as _,b as k,a5 as w,I as V,Z as S,t as C,f as R,n as U,N as I,O as j,ab as T}from"./index.e98e5106.js";import{_ as z}from"./uni-easyinput.249295d4.js";import{_ as B,a as L}from"./sys.ff097251.js";const N=a({__name:"Code",props:{wait:{default:60},keep:{type:Boolean,default:!0},startText:{default:"获取验证码"},waitingText:{default:"x秒重新获取"},endText:{default:"重新获取"}},emits:["change"],setup(e,{expose:a,emit:c}){const m="is-running";let p=l(e.keep?i(m):0),f=l(e.startText),x=l(e.wait),h=l(null);function g(){clearInterval(h.value),p.value=+new Date,b(),h.value=setInterval(b,1e3)}function y(){b(),h.value=setInterval(b,1e3)}function b(){if(x.value<=0)return clearInterval(h.value),f.value=e.endText,x.value=e.wait,void(p.value=0);f.value=e.waitingText.replace("x",String(x.value--))}return t(g,"start"),t(y,"recover"),t(b,"tick"),p.value&&(x.value=e.wait-Math.ceil((+new Date-p.value)/1e3),y()),u(p,(()=>e.keep&&v(m,p.value))),n((()=>c("change",f.value))),n((()=>console.log("num",x.value))),o((()=>clearInterval(h.value))),a({start:g,waiting:s((()=>!!p.value)),text:f}),(e,t)=>(d(),r("div"))}});const A={name:"CodeInput",props:{maxlength:{type:[String,Number],default:6},dot:{type:Boolean,default:!1},mode:{type:String,default:"box"},hairline:{type:Boolean,default:!1},space:{type:[String,Number],default:10},modelValue:{type:[String,Number],default:""},focus:{type:Boolean,default:!1},bold:{type:Boolean,default:!1},color:{type:String,default:"#606266"},fontSize:{type:[String,Number],default:18},size:{type:[String,Number],default:35},disabledKeyboard:{type:Boolean,default:!1},borderColor:{type:String,default:"#c9cacc"},disabledDot:{type:Boolean,default:!0}},data:()=>({inputValue:""}),computed:{value(){return this.modelValue},codeLength(){return new Array(Number(this.maxlength))},itemStyle(){return e=>{const t=c.addUnit,a={width:t(this.size),height:t(this.size)};return"box"===this.mode&&(a.border=`${this.hairline?.5:1}px solid ${this.borderColor}`,0===this.space&&(0===e&&(a.borderTopLeftRadius="3px",a.borderBottomLeftRadius="3px"),e===this.codeLength.length-1&&(a.borderTopRightRadius="3px",a.borderBottomRightRadius="3px"),e!==this.codeLength.length-1&&(a.borderRight="none"))),e!==this.codeLength.length-1?a.marginRight=t(this.space):a.marginRight=0,a}},codeArray(){return String(this.inputValue).split("")},lineStyle(){const e={};return e.height=this.hairline?"2px":"4px",e.width=c.addUnit(this.size),e.backgroundColor=this.borderColor,e}},watch:{value:{immediate:!0,handler(e){this.inputValue=String(e).substring(0,this.maxlength)}}},methods:{inputHandler(e){const t=e.detail.value;this.inputValue=t,this.disabledDot&&this.$nextTick((()=>{this.inputValue=t.replace(".","")})),this.$emit("change",t),this.$emit("update:modelValue",t),String(t).length>=Number(this.maxlength)&&this.$emit("finish",t)}}};function D(e,t,a,l,i,u){const n=k,o=w,s=V;return d(),m(n,{class:"u-code-input"},{default:p((()=>[(d(!0),r(b,null,f(u.codeLength,((t,l)=>(d(),m(n,{key:l,class:"u-code-input__item",style:x([u.itemStyle(l)])},{default:p((()=>[a.dot&&u.codeArray.length>l?(d(),m(n,{key:0,class:"u-code-input__item__dot"})):(d(),m(o,{key:1,style:x({fontSize:e.app.addUnit(a.fontSize),fontWeight:a.bold?"bold":"normal",color:a.color})},{default:p((()=>[h(g(u.codeArray[l]),1)])),_:2},1032,["style"])),"line"===a.mode?(d(),m(n,{key:2,class:"u-code-input__item__line",style:x([u.lineStyle])},null,8,["style"])):y("v-if",!0)])),_:2},1032,["style"])))),128)),_(s,{disabled:a.disabledKeyboard,type:"number",focus:a.focus,value:i.inputValue,maxlength:a.maxlength,class:"u-code-input__input",style:x({height:e.app.addUnit(a.size)}),onInput:u.inputHandler},null,8,["disabled","focus","value","maxlength","style","onInput"])])),_:1})}t(D,"_sfc_render");var $=B(A,[["render",D],["__scopeId","data-v-822c7c02"]]);var O=B(a({__name:"login",setup(e){const a=S(),i=C(a,"from");let u=l(!0),o=l("123"),s=l("2490445193@qq.com"),v=l(""),f=l(""),x=l(""),h=l(""),b=l(!1);n((()=>T({title:u.value?"登录":"注册"})));let k=l("");async function w(){if(!b.value)return c.toast("请先阅读并同意服务条款");if(u.value){if(!o.value)return c.toast("请输入账号");if(!f.value)return c.toast("请输入密码");await c.User.login({account:o.value,password:f.value,auth_type:"PASSWORD"}),c.back("登录成功")}else{if(!x.value)return c.toast("请输入用户名");if(!s.value)return c.toast("请输入邮箱");if(!f.value)return c.toast("请输入密码");if(!h.value)return c.toast("请重复输入密码");if(f.value!==h.value)return c.toast("两次密码不一致");if(!v.value)return c.toast("请输入验证码");await c.User.register({account:s.value,code:v.value,username:x.value,password:f.value}),c.to("#user/afterRegister",{from:i.value})}}t(w,"submit");let V=l(null);function B(e,t){return t?(console.log(V.value,V.value.waiting),V.value.waiting?c.toast("倒计时结束后再发送"):(k.value="正在发送...",void V.value.start())):c.toast("请输入"+e)}return n((()=>console.log(V.value))),t(B,"getCode"),(e,t)=>{const a=I(j("uni-easyinput"),z),l=I(j("sys"),L);return d(),m(l,null,{default:p((()=>[R("div",{"flex-center":""},[R("div",{thin:"",mt2xl:"",mb5xl:"",w640:""},[R("div",{py:"",pl:"","bg-hex-f6f8fa":"",flex:""},[R("div",{"flex-1":""},[R("div",{"text-35":"","font-bold":""},"欢迎来到思潮"),R("div",{pysm:"","text-23":""},[R("div",{"flex-center":"","justify-start":""},[R("div",{w10:"",h10:"",mrxs:"","i-ri-checkbox-blank-circle-fill":""}),R("span",null,"请先阅读:")]),R("div",{"ml-50":"",mtxs:""},[R("div",{"text-hex-1989C8":""},"《思潮用户服务协议》"),R("div",{"text-hex-1989C8":""},"《思潮隐私声明》")])]),R("div",{mtsm:"","flex-center":"","justify-start":"",onClick:t[0]||(t[0]=e=>b.value=!b.value)},[R("div",{class:U(["radio",{checked:b.value}])},null,2),R("div",{"text-23":""},"我已阅读并同意上述服务条款")])]),R("div",{w1:"",h100:"","bg-hex-929292":"","self-end":"",mbxlsm:""}),R("div",{"flex-center-col":"",pxlg:"","justify-between":"",onClick:t[1]||(t[1]=e=>u.value=!u.value)},[R("div",null,"logo"),u.value?(d(),r("div",{key:0,"flex-center-col":""},[R("span",{mbxs:"","text-gray":"","text-20":""},"还没有账号?"),R("span",{"text-hex-1989C8":"","text-27":""},"点此注册")])):(d(),r("div",{key:1,"flex-center-col":""},[R("span",{mbxs:"","text-gray":"","text-20":""},"已拥有账号?"),R("span",{"text-hex-1989C8":"","text-27":""},"点此登录")]))])]),R("div",{ptlg:"",pxxl:""},[u.value?(d(),r("div",{key:0,mblg:""},[R("div",{"text-25":"",mb4:""},"手机号 / 邮箱 / 用户名"),_(a,{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value=e)},null,8,["modelValue"])])):y("v-if",!0),u.value?y("v-if",!0):(d(),r("div",{key:1,mblg:""},[R("div",{"text-25":"",mb4:""},"用户名"),_(a,{modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=e=>x.value=e)},null,8,["modelValue"])])),_(N,{ref_key:"Coder",ref:V,onChange:t[4]||(t[4]=e=>k.value=e)},null,512),u.value?y("v-if",!0):(d(),r("div",{key:2,mblg:""},[R("div",{"text-25":"",mb4:""},"邮箱"),R("div",{"flex-center":"","justify-end":""},[_(a,{modelValue:s.value,"onUpdate:modelValue":t[6]||(t[6]=e=>s.value=e)},{right:p((()=>[R("div",{h50:"",w180:"",pyxs:"","bg-hex-f6f8fa":"","text-hex-6991c7":"","flex-center":"","thin-12-6991c7":"","text-23":"",mr5px:"",onClick:t[5]||(t[5]=e=>B("邮箱",s.value))},g(k.value),1)])),_:1},8,["modelValue"])])])),R("div",{mblg:""},[R("div",{"text-25":"",mb4:""},"密码"),_(a,{modelValue:f.value,"onUpdate:modelValue":t[7]||(t[7]=e=>f.value=e),type:"password"},null,8,["modelValue"])]),u.value?y("v-if",!0):(d(),r("div",{key:3,mblg:""},[R("div",{"text-25":"",mb4:""},"重复密码"),_(a,{modelValue:h.value,"onUpdate:modelValue":t[8]||(t[8]=e=>h.value=e),type:"password"},null,8,["modelValue"])])),u.value?y("v-if",!0):(d(),r("div",{key:4,mblg:""},[R("div",{"text-25":"",mb4:""},"验证码"),_($,{modelValue:v.value,"onUpdate:modelValue":t[9]||(t[9]=e=>v.value=e),mode:"box",space:0,maxlength:6,hairline:""},null,8,["modelValue"])]))]),R("div",{mt3xl:"",plg:"",flex:"","justify-between":""},[u.value?(d(),r("div",{key:0,"text-25":"","self-end":"","text-hex-1989C8":""},"忘记密码")):(d(),r("div",{key:1})),R("div",{"rounded-12":"","text-white":"",pysm:"",px3xl:"","bg-hex-6991c7":"",onClick:w},"提交")])])])])),_:1})}}}),[["__scopeId","data-v-2cc9a56e"]]);export{O as default};
