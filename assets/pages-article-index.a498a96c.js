var e=Object.defineProperty,t=(t,a)=>e(t,"name",{value:a,configurable:!0});import{d as a,o as s,a as l,r as n,b as i,g as o,j as d,e as r,_ as u,a0 as c,x as p,m as v,c as m,w as f,n as h,l as x,p as g,y,a1 as b,i as w,L as _,M as $,F as k,J as I,k as V,a2 as N,h as j,X as T,t as S,H as D,D as P,E,a3 as O,G as B,a4 as C,a5 as U}from"./index.e9853784.js";import{D as L,i as R,a as G,_ as W}from"./Draggable.5270a2ef.js";import{_ as z,a as F}from"./sys.5671f881.js";import{m as H}from"./merge.c19a1b4f.js";const M={mounted(){console.log(this.$ownerInstance),new L(this.$ownerInstance.$el)},methods:{getId(...e){console.log(e)}}};var A=t((e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("render"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.render=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(M)}),"block0$1");const J=a({__name:"Droppable",props:{id:{default:"unknown"}},setup:e=>(t,a)=>(s(),l("div",{class:"droppable","data-id":e.id,relative:""},[n(t.$slots,"default",{},(()=>[i("div",{h30:""})]),!0),i("div",{contents:"",class:"normal"},[n(t.$slots,"normal",{},void 0,!0)]),i("div",{contents:"",class:"active"},[n(t.$slots,"active",{},void 0,!0)])],8,["data-id"]))});"function"==typeof A&&A(J);var X=z(J,[["__scopeId","data-v-196bf6be"]]);R&&window,R&&window.document,R&&window.navigator,R&&window.location;const q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},K="__vueuse_ssr_handlers__";var Q,Y;function Z(e,a,s,l={}){var n,i,c;const{passive:p=!1,eventName:v,deep:m=!1,defaultValue:f}=l,h=u(),x=s||(null==h?void 0:h.emit)||(null==(n=null==h?void 0:h.$emit)?void 0:n.bind(h))||(null==(c=null==(i=null==h?void 0:h.proxy)?void 0:i.$emit)?void 0:c.bind(null==h?void 0:h.proxy));let g=v;a||(a="modelValue"),g=v||g||`update:${a.toString()}`;const y=t((()=>G(e[a])?e[a]:f),"getValue");if(p){const t=o(y());return d((()=>e[a]),(e=>t.value=e)),d(t,(t=>{(t!==e[a]||m)&&x(g,t)}),{deep:m}),t}return r({get:()=>y(),set(e){x(g,e)}})}q[K]=q[K]||{},q[K],(Y=Q||(Q={})).UP="UP",Y.RIGHT="RIGHT",Y.DOWN="DOWN",Y.LEFT="LEFT",Y.NONE="NONE",t(Z,"useVModel");const ee={mounted(){this.$ownerInstance.$el.addEventListener("keyup",(()=>{console.log("keyup",this.$ownerInstance.$el.innerText),this.$ownerInstance.callMethod("onInput",this.$ownerInstance.$el.innerText)}))}};var te=t((e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("render"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.render=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(ee)}),"block0");const ae=a({...{methods:{onInput(e){this.$emit("update:modelValue",e)}}},__name:"index",props:{modelValue:null,placeholder:{default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const a=Z(c(e,["placeholder"]),"modelValue",t);return(t,n)=>(s(),l("div",{placeholder:e.placeholder,class:"content",contenteditable:""},p(v(a)),9,["placeholder"]))}});"function"==typeof te&&te(ae);var se=z(ae,[["__scopeId","data-v-eeadecee"]]);const le={name:"UniBadge",emits:["click"],props:{type:{type:String,default:"error"},inverted:{type:Boolean,default:!1},isDot:{type:Boolean,default:!1},maxNum:{type:Number,default:99},absolute:{type:String,default:""},offset:{type:Array,default:()=>[0,0]},text:{type:[String,Number],default:""},size:{type:String,default:"small"},customStyle:{type:Object,default:()=>({})}},data:()=>({}),computed:{width(){return 8*String(this.text).length+12},classNames(){const{inverted:e,type:t,size:a,absolute:s}=this;return[e?"uni-badge--"+t+"-inverted":"","uni-badge--"+t,"uni-badge--"+a,s?"uni-badge--absolute":""].join(" ")},positionStyle(){if(!this.absolute)return{};let e=this.width/2,t=10;this.isDot&&(e=5,t=5);const a=`${-e+this.offset[0]}px`,s=`${-t+this.offset[1]}px`,l={rightTop:{right:a,top:s},rightBottom:{right:a,bottom:s},leftBottom:{left:a,bottom:s},leftTop:{left:a,top:s}},n=l[this.absolute];return n||l.rightTop},dotStyle(){return this.isDot?{width:"10px",minWidth:"0",height:"10px",padding:"0",borderRadius:"10px"}:{}},displayValue(){const{isDot:e,text:t,maxNum:a}=this;return e?"":Number(t)>a?`${a}+`:t}},methods:{onClick(){this.$emit("click")}}};function ne(e,t,a,l,i,o){const d=b,r=w;return s(),m(r,{class:"uni-badge--x"},{default:f((()=>[n(e.$slots,"default",{},void 0,!0),a.text?(s(),m(d,{key:0,class:h([o.classNames,"uni-badge"]),style:x([o.positionStyle,a.customStyle,o.dotStyle]),onClick:t[0]||(t[0]=e=>o.onClick())},{default:f((()=>[g(p(o.displayValue),1)])),_:1},8,["class","style"])):y("v-if",!0)])),_:3})}t(ne,"_sfc_render");var ie=z(le,[["render",ne],["__scopeId","data-v-18bbf508"]]);var oe=z(a({__name:"Toolbar",emits:["new-paragraph"],setup(e,{emit:t}){let a=o(!1);return(e,n)=>{const o=_($("uni-badge"),ie),d=W;return s(),l("div",{class:"toolbar"},[i("div",{class:"actions"},[a.value?(s(),l(k,{key:0},[i("div",{class:"publish"},[g(" 发布 "),i("div",{mlxs:""},[i("div",{"i-ri-share-forward-2-fill":""})])]),i("div",{class:"share"},[i("div",null,[i("div",{"i-ri-user-add-line":""})])])],64)):(s(),l("div",{key:1,"bg-white":"","flex-center":"",pxsm:"",prlg:""},[(s(),l(k,null,I(3,(e=>i("div",{key:e,"w-100":"","flex-center":""},[V(o,{size:"small",text:"10k",absolute:"rightTop",offset:[2,4],"max-num":NaN,"custom-style":{backgroundColor:"#fff",color:"#000",borderRadius:"0",padding:"0 4rpx"}},{default:f((()=>[1==e?(s(),l("div",{key:0,"i-ri-chat-3-line":"",w50:"",h50:""})):y("v-if",!0),2==e?(s(),l("div",{key:1,"i-ri-heart-3-line":"",w50:"",h50:""})):y("v-if",!0),3==e?(s(),l("div",{key:2,"i-ri-inbox-line":"",w50:"",h50:""})):y("v-if",!0)])),_:2},1024)]))),64))]))]),i("div",{w40:""}),V(d,{onOnPanend:n[0]||(n[0]=e=>t("new-paragraph",e))},{default:f((()=>[i("div",{class:"fab"},[i("div",{"i-fluent-add-28-regular":"",w59:"",h59:""})])])),_:1}),i("div",{class:"fabBack"},[i("div",null,[i("div",{"i-ri-close-line":"",w39:"",h39:""})])])])}}}),[["__scopeId","data-v-03aaa4e0"]]);var de=z(a({__name:"Paragraph",props:{context:null},setup(e){let t=o(!1);return N((()=>{t.value=e.context.new})),(a,n)=>(s(),l("div",{class:h(["paragraph",{new:t.value}])},p(e.context),3))}}),[["__scopeId","data-v-ad740a9c"]]);var re=z(a({__name:"Group",props:{context:null},setup(e){let t=o("");return j((()=>{console.log("group name",t.value)})),(a,n)=>{const o=se;return s(),l("div",{class:"group",mbxl:""},[i("div",{"flex-center":"",px:"",relative:"",mb:""},[V(o,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e),placeholder:"未命名分组","text-56":"","font-bold":""},null,8,["modelValue"]),i("div",{border:"t-dashed hex-e8e8e8","flex-1":"",mx:""}),i("div",{"i-ri-menu-4-line":"","text-56":"","text-gray":""})]),i("div",{contents:""},[(s(!0),l(k,null,I(e.context.paragraph,((e,t)=>(s(),m(de,{key:t,context:e},null,8,["context"])))),128))])])}}}),[["__scopeId","data-v-858e387e"]]);var ue=z(a({__name:"index",setup(e){const a=T(),n=S(a,"params"),r=D({}),u=D({}),c=new Proxy(u,{get:(e,t)=>e[t]||r[t],set:(e,t,a)=>!void(e[t]=a)});P(E).onLoad((async()=>{const{id:e}=await O((()=>n.value));console.log("初始化:",e),H(r,e?await B.getProject({id:e}):{}),console.log(r)}));let h=o("");async function x(){h.value="自动保存中...",await new Promise((e=>setTimeout(e,500))),h.value="自动保存成功"}t(x,"autoSaveRun"),d(u,C(x,1e3,{maxWait:5e3}),{deep:!0});const g=D([]);return(e,t)=>{const a=U,n=se,o=X,d=_($("sys"),F);return s(),m(d,null,{fixed:f((()=>[V(oe,{onNewParagraph:t[0]||(t[0]=e=>g.push({paragraph:[{new:!0}]}))})])),default:f((()=>[i("div",{"flex-center":""},[i("div",{pxy:""},[i("div",{"i-ri-arrow-left-line":""})]),i("div",{"flex-1":""}),i("div",{pxy:"","text-xs":"","text-gray":""},p(h.value),1),i("div",{pxy:""},[i("div",{"i-ri-menu-line":""})])]),i("div",{pxy:"",mb:""},[V(a,{modelValue:v(c).title,"onUpdate:modelValue":t[1]||(t[1]=e=>v(c).title=e),"auto-height":"",placeholder:"请输入标题",class:"textarea",maxlength:"400","placeholder-style":"color: #D5D5E0;"},null,8,["modelValue"]),V(n,{modelValue:v(c).description,"onUpdate:modelValue":t[2]||(t[2]=e=>v(c).description=e),placeholder:"添加描述","text-32":""},null,8,["modelValue"])]),g.length?y("v-if",!0):(s(),l("div",{key:0,mtxl:"",p60:""},[i("div",{class:"empty-target","flex-center":""},[V(o,{id:"empty-target",class:"empty-target-dropbox","flex-center":""},{normal:f((()=>[i("div",{"text-bluegray":""},"将"),i("div",{class:"fab","transform-scale-50":"","m--15":""},[i("div",{"i-fluent-add-28-regular":"",w70:"",h70:""})]),i("div",{"text-bluegray":""},"拖拽到此处, 添加你的第一个段落")])),active:f((()=>[i("div",{"text-bluegray":""},"在此释放, 添加你的第一个段落")])),_:1})])])),(s(!0),l(k,null,I(g,((e,t)=>(s(),m(re,{key:t,context:e},null,8,["context"])))),128))])),_:1})}}}),[["__scopeId","data-v-7756a7c7"]]);export{ue as default};
