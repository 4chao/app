var e=Object.defineProperty,t=(t,i)=>e(t,"name",{value:i,configurable:!0});import{d as i,o as s,c as a,w as l,r as n,i as r,a as o,b as d,t as v,e as u,u as c,f as h,g as p,h as x,j as m,k as f,n as g,l as y,m as b,p as w,q as k,v as _,s as H,x as B,y as E,z as I,F as j,A as $,B as T,C as z,I as C,S as G,D as O,E as S,G as L,H as A,J as q,K as F,L as U,M as D}from"./index.b1a19c12.js";import{_ as M}from"./ArticleCard.9991ac2d.js";import{_ as P,a as R}from"./sys.5a8a55cf.js";const V={data:()=>({scrollTop:0,min:0,max:0,focus:!0,height:12}),watch:{focus(e){e||(this.height=Math.abs(this.height-this.min)<Math.abs(this.height-this.max)?this.min:this.max,this.setHeight(!0))},scrollTop(e,t){if(e<=0)return this.height=this.max,this.setHeight(!0);this.focus&&(this.height+=t-e||0,this.height<this.min&&(this.height=this.min),this.height>this.max&&(this.height=this.max),this.setHeight(!1))}},mounted(){this.min=Number(this.$ownerInstance.$el.dataset.height),window.addEventListener("scroll",this.scrollHandler),window.addEventListener("touchstart",(()=>this.focus=!0)),window.addEventListener("touchend",(()=>this.focus=!1))},methods:{propObserver(e){console.log("props",e)},scrollHandler(){this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop},setHeight(e){this.$ownerInstance.$el.style.transition=e?"all 0.3s cubic-bezier(.15,.7,.35,1)":"none",this.$ownerInstance.$el.style.transform="translateY("+this.height+"px)"}}};var K=t((e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("renderBiz"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.renderBiz=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(V)}),"block0$1");const J=i({__name:"Sticker",props:{back:{default:40}},setup:e=>(t,i)=>{const o=r;return s(),a(o,{id:"sticker","data-height":e.back,style:{willchange:"transform"}},{default:l((()=>[n(t.$slots,"default",{},void 0,!0)])),_:3},8,["data-height"])}});"function"==typeof K&&K(J);var N=P(J,[["__scopeId","data-v-0fad4d9b"]]);var W=P(i({__name:"ArticleCardRecentlyEdited",props:{allowBanner:{type:Boolean,default:!0},allowTag:{type:Boolean,default:!0},allowTitle:{type:Boolean,default:!0}},setup:e=>(e,t)=>(s(),o("div",null,[d("div",{class:"card","shadow-box":""},[d("div",{pxsm:"",pysm:"","bg-hex-f6f8fa":""},[d("div",{class:"title","text-35":"","line-clamp-2":""},"福建一男子摄入卡路里结果卡路里"),d("div",{flex:"","justify-between":"","text-20":"","text-gray":"",mtxs:""},[d("div",{"flex-center":""},[d("div",{"i-ri-star-fill":"",mrxs:""}),d("div",null,"238"),d("div",{"i-ri-thumb-up-fill":"",mlsm:"",mrxs:""}),d("div",null,"1.5k+"),d("div",{"i-ri-brush-fill":"",mlsm:"",mrxs:""}),d("div",null,"24")]),d("div")])]),d("div",{psm:"",flex:"","justify-between":"","text-20":"","text-gray":"","bg-white":""},[d("div",null,"3 天前编辑    345字"),d("div",null,"继续编辑")])])]))}),[["__scopeId","data-v-1a9df2a9"]]);const Y={mounted(){let e=document.querySelector(".mescroll-body"),i=document.querySelector("#articles"),s=document.querySelector("#renderHelper");e.style.transition="transform 1s cubic-bezier(0,.63,.27,1)",i.style.transition="transform 1s",i.style.transform="translate(0,0)";let a={xAxis:0,yAxis:0};function l(t){t.xAxis&&(a=t),e.style.transformOrigin="center "+(document.documentElement.scrollTop+document.documentElement.clientHeight/2)+"px","true"==s.dataset.open?(e.style.transform="scale(0.9)",i.style.transform="translate("+5*+a.xAxis.toFixed(3)+"px,"+5*-a.yAxis.toFixed(3)+"px)"):(e.style.transform="scale(1)",i.style.transform="translate(0,0)")}t(l,"setValue"),new MutationObserver(l).observe(s,{attributes:!0})}};var Q=t((e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("renderBiz"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.renderBiz=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(Y)}),"block0");const X=i({__name:"Search",setup(e){var i;let a=$("searchInfo"),n=v(a,"value"),O=v(a,"searched");const S=u({get:()=>M.value&&!U.value&&n.value||O.value,set:e=>n.value=e});function L(e){return e*T.Global.navBarHeight+"px"}t(L,"navHpx");let A=c(30);var q=!1;h((({from:e})=>{if("backbutton"===e&&M.value)return M.value=!1,!0}));let F=p(!1),U=p(!1),D=p(!1),M=u({get:()=>F.value||U.value,set:()=>F.value=U.value=D.value=!1});function P(){return 1==D.value?D.value=!1:(M.value||T.to("#article",{id:123123}),U.value?U.value=!1:n.value?n.value="":M.value=!1)}x((()=>U.value&&(F.value=!1))),m(M,(()=>D.value=!1)),t(P,"rightBtn");let R=p(0);null==(i=uni.onKeyboardHeightChange)||i.call(uni,(({height:e})=>{R.value=e,e&&(V.value=K.value)}));let V=p(c(1e3)),K=u((()=>{let e=T.Global.systemInfo.windowHeight-T.Global.systemInfo.statusBarHeight-R.value-c(50)||V.value;return e>V.value?V.value:e}));return(e,t)=>{const i=r,a=z,n=C,v=G,u=N;return s(),o(j,null,[f(u,{class:"sticker",style:y({top:e.app.Global.systemInfo.statusBarHeight+"px"}),back:-e.app.Global.navBarHeight-e.app.Global.systemInfo.statusBarHeight-b(A)},{default:l((()=>[d("div",{style:y({height:e.app.Global.navBarHeight+"px",marginRight:-e.app.Global.capsuleMarginRight+"px",padding:b(q)?"":"20rpx 0 0 0",paddingRight:e.app.Global.capsuleWidth+"px"}),relative:"",flex:"",onTouchmove:t[8]||(t[8]=I((()=>{}),["stop","prevent"]))},[d("div",{"shadow-box":"",class:g(["menubar",{act:D.value}]),style:y({right:b(q)?"40rpx":"20rpx"})},[f(i,{onClick:t[0]||(t[0]=t=>e.app.to("#article/new"))},{default:l((()=>[f(i,{"i-ri-ball-pen-line":""}),w(" 新的创作 ")])),_:1}),f(i,null,{default:l((()=>[f(i,{"i-ri-qr-scan-2-line":""}),w(" 扫一扫 ")])),_:1})],6),d("div",{style:y({height:K.value+"px"}),relative:"",flex:"","flex-grow":"","flex-col":"","pointer-events-none":""},[d("div",{"shadow-box":"","pointer-events-auto":"",mxsm:"",pxsm:"","flex-center":"","justify-start":"",style:y({height:e.app.Global.navBarHeight+"px"}),class:g(["wave",{active:M.value}])},[d("div",{"flex-center":"",onLongpress:t[3]||(t[3]=t=>e.app.to("#test"))},[k(f(a,{style:y({height:L((b(q),.6)),width:L((b(q),.6))}),class:"smooth",src:"https://q2.qlogo.cn/headimg_dl?dst_uin=2490445193&spec=100&v=0.5662477152747005",onClick:t[1]||(t[1]=e=>U.value=!U.value)},null,8,["style"]),[[_,e.app.User.isLogin]]),k(d("div",{style:y({height:L((b(q),.6)),width:L((b(q),.6))}),class:"smooth login-btn","flex-center":"","text-20":"","font-bold":"","text-white":"",onClick:t[2]||(t[2]=t=>e.app.to("#user/login").then((t=>t&&e.app.toast(t))))}," 登录 ",4),[[_,!e.app.User.isLogin]])],32),d("div",{relative:"","h-full":"","flex-grow":"",mxsm:""},[f(n,{modelValue:b(S),"onUpdate:modelValue":t[4]||(t[4]=e=>H(S)?S.value=e:null),class:g(["ab",{hide:U.value}]),"auto-blur":"","h-full":"","w-full":"",placeholder:"搜索思潮",style:y({fontSize:L(b(q)?.35:.3)}),onFocus:t[5]||(t[5]=e=>{R.value=e.detail.height,F.value=!0})},null,8,["modelValue","class","style"]),d("div",{class:g(["ab",{hide:!U.value}]),"flex-center":"","bg-white":""},[d("div",{"flex-1":"",flex:"","flex-col":"","justify-center":""},[d("div",{flex:"","items-center":""},[d("span",{"text-38":"",mrxs:""},B(e.app.User.userInfo.username),1),d("span",{"text-20":"","text-gray":"","self-end":"",pb4:""},"#"+B(e.app.User.userInfo.id),1),d("div",{"flex-1":""}),E(" TODO: 上线前搞个内测徽章 "),E(" <div>徽章</div> ")]),d("div",{flex:"","items-center":"","text-24":"","text-gray-500":""},[d("div",{"i-ri-edit-2-fill":"",mrxs:"","shrink-0":""}),"$Default"==e.app.User.userInfo.signature?(s(),o("div",{key:0},"点此设置签名...")):(s(),o("div",{key:1,"line-clamp-1":"","break-all":""},B(e.app.User.userInfo.signature),1))])]),d("div",{style:{height:"60%"},"w-1px":"",mlsm:"",mrxs:"","bg-gray-200":""}),d("div",{"flex-center":"",mlsm:"",style:y({fontSize:L((b(q),.35))}),onClick:t[6]||(t[6]=t=>e.app.to("#user/setting").then((t=>t&&e.app.toast(t))))},[d("div",{"i-ri-settings-2-line":""})],4)],2)]),d("div",{"flex-center":"",style:y({fontSize:L((b(q),.5))})},[d("div",{"i-ri-close-fill":"",class:g(["x",{act:M.value||D.value}]),onClick:I(P,["prevent","stop"])},null,10,["onClick"])],4)],6),d("div",{"flex-grow":"",relative:"","pointer-events-none":""},[f(v,{"scroll-y":"",class:g(["ab history shadow-box",{hide:!F.value}]),onTouchend:t[7]||(t[7]=I((()=>{}),["prevent"]))},{default:l((()=>[E(" 搜索记录和推荐 "),d("div",{py30:""},"111111111111111111111"),d("div",{py30:""},"111111111111111111111"),d("div",{py30:""},"111111111111111111111"),d("div",{py30:""},"111111111111111111111"),d("div",{py30:""},"111111111111111111111"),d("div",{py30:""},"111111111111111111111")])),_:1},8,["class"]),d("div",{class:g(["ab profile",{hide:!U.value}])},[d("div",{class:"lay",flex:"",h600:"",mbsm:""},[d("div",{"shadow-box":"","h-full":"",w400:""},"TODO:个人卡片"),d("div",{class:"lay","h-full":"",psm:""},[d("div",null,"TODO:历史记录,个人收藏等私密信息")])]),d("div",{"shadow-box":"",mbsm:"",pylg:"","flex-center":"","justify-around":"","text-25":""},[E(" <div border border-dashed mbsm pylg flex-center justify-around> "),d("div",{"flex-center-col":""},[d("div",{w40:"",h40:"",mbxs:"","i-ri-chat-heart-line":""}),w(" 回复我的 ")]),d("div",{"flex-center-col":""},[d("div",{w40:"",h40:"",mbxs:"","i-ri-thumb-up-line":""}),w(" 收到的赞 ")]),d("div",{"flex-center-col":""},[d("div",{w40:"",h40:"",mbxs:"","i-ri-mail-line":""}),w(" 我的私信 ")]),d("div",{"flex-center-col":""},[d("div",{w40:"",h40:"",mbxs:"","i-ri-notification-4-line":""}),w(" 系统通知 ")])]),f(W),E(' <div flex-center class="rowFn">\n              <div\n                v-for="e in rowFn.map(e => e.split(\'|\'))"\n                flex-1\n                flex-center-col\n                pysm\n                class="wave click"\n              >\n                <div text-24>{{ e[0] }}</div>\n                <div text-22>123</div>\n              </div>\n            </div>\n            <div msm text-right text-20 text-gray fira>个人主页 -></div> '),E(' <scroll-view scroll-x enable-flex class="rowProj">\n              <div flex>\n                <div fira>&#xEE03;&#xEE04;&#xEE04;&#xEE04;&#xEE01;&#xEE02;</div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n              </div>\n            </scroll-view> '),E(" <div absolute top-full left-0 right-0 text-18 ptxs flex-center text-gray-6 fira>\n              <div>2022-04-15 加入思潮</div>\n              <div flex-1></div>\n              <div>v0.0.34:65335</div>\n            </div> ")],2)])],4)],36)])),_:1},8,["style","back"]),d("div",{class:g(["mask",{show:M.value||D.value}]),onClick:t[9]||(t[9]=I((e=>M.value=!1),["stop"])),onTouchmove:t[10]||(t[10]=I((()=>{}),["stop","prevent"]))},null,34),d("div",{id:"renderHelper","data-open":M.value||D.value},null,8,["data-open"])],64)}}});"function"==typeof Q&&Q(X);var Z=P(X,[["__scopeId","data-v-36b0f76c"]]);const ee=i({__name:"index",setup(e){let t=T.Data,i=v(t,"indexList");O(S).onLoad((e=>{})).onFetch((async e=>{let t={page:e.num,size:e.size,last_time:e.time};const{data:s,total:a}=await L.getProjectPage(t);0==e.num&&(i.value=[]),i.value=i.value.concat(s),e.endBySize(s.length,a,e.time)}));const n=A({value:"",searched:""});F("searchInfo",n);let r=u((()=>{const{navBarHeight:e}=T.Global,{statusBarHeight:t}=T.Global.systemInfo;return e+t+c(30)+"px"}));return(e,t)=>{const n=M,v=U(D("sys"),R);return s(),a(v,{top:r.value},{fixed:l((()=>[f(Z)])),default:l((()=>[d("div",{id:"articles",ptsm:""},[(s(!0),o(j,null,q(i.value,(e=>(s(),a(n,{key:e.id,data:e},null,8,["data"])))),128))])])),_:1},8,["top"])}}});export{ee as default};
