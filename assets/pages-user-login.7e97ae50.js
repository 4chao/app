var e=Object.defineProperty,t=(t,a)=>e(t,"name",{value:a,configurable:!0});import{d as a,g as l,P as i,j as u,h as n,Y as o,e as s,o as d,a as r,Q as v,B as c,c as p,w as m,J as f,l as x,p as h,x as g,y,F as b,k as _,i as k,_ as w,I as V,X as S,t as C,b as U,n as I,L as R,M as j,af as B}from"./index.645f1e0b.js";import{_ as T}from"./uni-easyinput.0706d0bc.js";import{_ as z,a as L}from"./sys.b3ee287c.js";const N=a({__name:"Code",props:{wait:{default:60},keep:{type:Boolean,default:!0},startText:{default:"获取验证码"},waitingText:{default:"x秒重新获取"},endText:{default:"重新获取"}},emits:["change"],setup(e,{expose:a,emit:c}){const p="is-running";let m=l(e.keep?i(p):0),f=l(e.startText),x=l(e.wait),h=l(null);function g(){clearInterval(h.value),m.value=+new Date,b(),h.value=setInterval(b,1e3)}function y(){b(),h.value=setInterval(b,1e3)}function b(){if(x.value<=0)return clearInterval(h.value),f.value=e.endText,x.value=e.wait,void(m.value=0);f.value=e.waitingText.replace("x",String(x.value--))}return t(g,"start"),t(y,"recover"),t(b,"tick"),m.value&&(x.value=e.wait-Math.ceil((+new Date-m.value)/1e3),y()),u(m,(()=>e.keep&&v(p,m.value))),n((()=>c("change",f.value))),n((()=>console.log("num",x.value))),o((()=>clearInterval(h.value))),a({start:g,waiting:s((()=>!!m.value)),text:f}),(e,t)=>(d(),r("div"))}});const $={name:"CodeInput",props:{maxlength:{type:[String,Number],default:6},dot:{type:Boolean,default:!1},mode:{type:String,default:"box"},hairline:{type:Boolean,default:!1},space:{type:[String,Number],default:10},modelValue:{type:[String,Number],default:""},focus:{type:Boolean,default:!1},bold:{type:Boolean,default:!1},color:{type:String,default:"#606266"},fontSize:{type:[String,Number],default:18},size:{type:[String,Number],default:35},disabledKeyboard:{type:Boolean,default:!1},borderColor:{type:String,default:"#c9cacc"},disabledDot:{type:Boolean,default:!0}},data:()=>({inputValue:""}),computed:{value(){return this.modelValue},codeLength(){return new Array(Number(this.maxlength))},itemStyle(){return e=>{const t=c.addUnit,a={width:t(this.size),height:t(this.size)};return"box"===this.mode&&(a.border=`${this.hairline?.5:1}px solid ${this.borderColor}`,0===this.space&&(0===e&&(a.borderTopLeftRadius="3px",a.borderBottomLeftRadius="3px"),e===this.codeLength.length-1&&(a.borderTopRightRadius="3px",a.borderBottomRightRadius="3px"),e!==this.codeLength.length-1&&(a.borderRight="none"))),e!==this.codeLength.length-1?a.marginRight=t(this.space):a.marginRight=0,a}},codeArray(){return String(this.inputValue).split("")},lineStyle(){const e={};return e.height=this.hairline?"2px":"4px",e.width=c.addUnit(this.size),e.backgroundColor=this.borderColor,e}},watch:{value:{immediate:!0,handler(e){this.inputValue=String(e).substring(0,this.maxlength)}}},methods:{inputHandler(e){const t=e.detail.value;this.inputValue=t,this.disabledDot&&this.$nextTick((()=>{this.inputValue=t.replace(".","")})),this.$emit("change",t),this.$emit("update:modelValue",t),String(t).length>=Number(this.maxlength)&&this.$emit("finish",t)}}};function A(e,t,a,l,i,u){const n=k,o=w,s=V;return d(),p(n,{class:"u-code-input"},{default:m((()=>[(d(!0),r(b,null,f(u.codeLength,((t,l)=>(d(),p(n,{key:l,class:"u-code-input__item",style:x([u.itemStyle(l)])},{default:m((()=>[a.dot&&u.codeArray.length>l?(d(),p(n,{key:0,class:"u-code-input__item__dot"})):(d(),p(o,{key:1,style:x({fontSize:e.app.addUnit(a.fontSize),fontWeight:a.bold?"bold":"normal",color:a.color})},{default:m((()=>[h(g(u.codeArray[l]),1)])),_:2},1032,["style"])),"line"===a.mode?(d(),p(n,{key:2,class:"u-code-input__item__line",style:x([u.lineStyle])},null,8,["style"])):y("v-if",!0)])),_:2},1032,["style"])))),128)),_(s,{disabled:a.disabledKeyboard,type:"number",focus:a.focus,value:i.inputValue,maxlength:a.maxlength,class:"u-code-input__input",style:x({height:e.app.addUnit(a.size)}),onInput:u.inputHandler},null,8,["disabled","focus","value","maxlength","style","onInput"])])),_:1})}t(A,"_sfc_render");var D=z($,[["render",A],["__scopeId","data-v-822c7c02"]]);var P=z(a({__name:"login",setup(e){const a=S(),i=C(a,"from");let u=l(!0),o=l("123"),s=l("2490445193@qq.com"),v=l(""),f=l(""),x=l(""),h=l(""),b=l(!1);n((()=>B({title:u.value?"登录":"注册"})));let k=l("");async function w(){if(!b.value)return c.toast("请先阅读并同意服务条款");if(u.value){if(!o.value)return c.toast("请输入账号");if(!f.value)return c.toast("请输入密码");await c.User.login({account:o.value,password:f.value,auth_type:"PASSWORD"}),c.back("登录成功")}else{if(!x.value)return c.toast("请输入用户名");if(!s.value)return c.toast("请输入邮箱");if(!f.value)return c.toast("请输入密码");if(!h.value)return c.toast("请重复输入密码");if(f.value!==h.value)return c.toast("两次密码不一致");if(!v.value)return c.toast("请输入验证码");await c.User.register({account:s.value,code:v.value,username:x.value,password:f.value}),c.to("#user/afterRegister",{from:i.value})}}t(w,"submit");let V=l(null);function z(e,t){return t?(console.log(V.value,V.value.waiting),V.value.waiting?c.toast("倒计时结束后再发送"):(k.value="正在发送...",void V.value.start())):c.toast("请输入"+e)}return n((()=>console.log(V.value))),t(z,"getCode"),(e,t)=>{const a=R(j("uni-easyinput"),T),l=R(j("sys"),L);return d(),p(l,null,{default:m((()=>[U("div",{"flex-center":""},[U("div",{thin:"",mt2xl:"",mb5xl:"",w640:""},[U("div",{py:"",pl:"","bg-hex-f6f8fa":"",flex:""},[U("div",{"flex-1":""},[U("div",{"text-35":"","font-bold":""},"欢迎来到思潮"),U("div",{pysm:"","text-23":""},[U("div",{"flex-center":"","justify-start":""},[U("div",{w10:"",h10:"",mrxs:"","i-ri-checkbox-blank-circle-fill":""}),U("span",null,"请先阅读:")]),U("div",{"ml-50":"",mtxs:""},[U("div",{"text-hex-1989C8":""},"《思潮用户服务协议》"),U("div",{"text-hex-1989C8":""},"《思潮隐私声明》")])]),U("div",{mtsm:"","flex-center":"","justify-start":"",onClick:t[0]||(t[0]=e=>b.value=!b.value)},[U("div",{class:I(["radio",{checked:b.value}])},null,2),U("div",{"text-23":""},"我已阅读并同意上述服务条款")])]),U("div",{w1:"",h100:"","bg-hex-929292":"","self-end":"",mbxlsm:""}),U("div",{"flex-center-col":"",pxlg:"","justify-between":"",onClick:t[1]||(t[1]=e=>u.value=!u.value)},[U("div",null,"logo"),u.value?(d(),r("div",{key:0,"flex-center-col":""},[U("span",{mbxs:"","text-gray":"","text-20":""},"还没有账号?"),U("span",{"text-hex-1989C8":"","text-27":""},"点此注册")])):(d(),r("div",{key:1,"flex-center-col":""},[U("span",{mbxs:"","text-gray":"","text-20":""},"已拥有账号?"),U("span",{"text-hex-1989C8":"","text-27":""},"点此登录")]))])]),U("div",{ptlg:"",pxxl:""},[u.value?(d(),r("div",{key:0,mblg:""},[U("div",{"text-25":"",mb4:""},"手机号 / 邮箱 / 用户名"),_(a,{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value=e)},null,8,["modelValue"])])):y("v-if",!0),u.value?y("v-if",!0):(d(),r("div",{key:1,mblg:""},[U("div",{"text-25":"",mb4:""},"用户名"),_(a,{modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=e=>x.value=e)},null,8,["modelValue"])])),_(N,{ref_key:"Coder",ref:V,onChange:t[4]||(t[4]=e=>k.value=e)},null,512),u.value?y("v-if",!0):(d(),r("div",{key:2,mblg:""},[U("div",{"text-25":"",mb4:""},"邮箱"),U("div",{"flex-center":"","justify-end":""},[_(a,{modelValue:s.value,"onUpdate:modelValue":t[6]||(t[6]=e=>s.value=e)},{right:m((()=>[U("div",{h50:"",w180:"",pyxs:"","bg-hex-f6f8fa":"","text-hex-6991c7":"","flex-center":"","thin-12-6991c7":"","text-23":"",mr5px:"",onClick:t[5]||(t[5]=e=>z("邮箱",s.value))},g(k.value),1)])),_:1},8,["modelValue"])])])),U("div",{mblg:""},[U("div",{"text-25":"",mb4:""},"密码"),_(a,{modelValue:f.value,"onUpdate:modelValue":t[7]||(t[7]=e=>f.value=e),type:"password"},null,8,["modelValue"])]),u.value?y("v-if",!0):(d(),r("div",{key:3,mblg:""},[U("div",{"text-25":"",mb4:""},"重复密码"),_(a,{modelValue:h.value,"onUpdate:modelValue":t[8]||(t[8]=e=>h.value=e),type:"password"},null,8,["modelValue"])])),u.value?y("v-if",!0):(d(),r("div",{key:4,mblg:""},[U("div",{"text-25":"",mb4:""},"验证码"),_(D,{modelValue:v.value,"onUpdate:modelValue":t[9]||(t[9]=e=>v.value=e),mode:"box",space:0,maxlength:6,hairline:""},null,8,["modelValue"])]))]),U("div",{mt3xl:"",plg:"",flex:"","justify-between":""},[u.value?(d(),r("div",{key:0,"text-25":"","self-end":"","text-hex-1989C8":""},"忘记密码")):(d(),r("div",{key:1})),U("div",{"rounded-12":"","text-white":"",pysm:"",px3xl:"","bg-hex-6991c7":"",onClick:w},"提交")])])])])),_:1})}}}),[["__scopeId","data-v-2cc9a56e"]]);export{P as default};
