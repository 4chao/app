var e=Object.defineProperty,t=(t,i)=>e(t,"name",{value:i,configurable:!0});import{i,d as a,a as l,o as s,c as n,w as r,r as o,b as d,e as v,f as u,t as c,g as h,u as p,h as x,j as m,k as f,l as g,m as y,n as b,p as w,q as _,s as k,v as E,x as H,y as I,z as B,A as j,B as $,F as T,C,D as z,E as G,I as O,S,G as L,H as A,J as F,K as q,L as U,M as D,N as M,O as P}from"./index.e98e5106.js";import{_ as R}from"./ArticleCard.c334df60.js";import{_ as V,a as K}from"./sys.ff097251.js";function N(e,t,l){var s=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(l)&&(s="leading"in l?!!l.leading:s,n="trailing"in l?!!l.trailing:n),a(e,t,{leading:s,maxWait:t,trailing:n})}t(N,"throttle");const W={data:()=>({scrollTop:0,min:0,max:0,focus:!0,height:12}),watch:{focus(e){e||(this.height=Math.abs(this.height-this.min)<Math.abs(this.height-this.max)?this.min:this.max,this.setHeight(!0))},scrollTop(e,t){if(e<=0)return this.height=this.max,this.setHeight(!0);this.focus&&(this.height+=t-e||0,this.height<this.min&&(this.height=this.min),this.height>this.max&&(this.height=this.max),this.setHeight(!1))}},mounted(){this.min=Number(this.$ownerInstance.$el.dataset.height),window.addEventListener("scroll",this.scrollHandler),window.addEventListener("touchstart",(()=>this.focus=!0)),window.addEventListener("touchend",(()=>this.focus=!1))},methods:{propObserver(e){console.log("props",e)},scrollHandler(){this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop},setHeight(e){this.$ownerInstance.$el.style.transition=e?"all 0.3s cubic-bezier(.15,.7,.35,1)":"none",this.$ownerInstance.$el.style.transform="translateY("+this.height+"px)"}}};var J=t((e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("renderBiz"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.renderBiz=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(W)}),"block0$1");const Y=l({__name:"Sticker",props:{back:{default:40}},setup:e=>(t,i)=>{const a=d;return s(),n(a,{id:"sticker","data-height":e.back,style:{willchange:"transform"}},{default:r((()=>[o(t.$slots,"default",{},void 0,!0)])),_:3},8,["data-height"])}});"function"==typeof J&&J(Y);var Q=V(Y,[["__scopeId","data-v-0fad4d9b"]]);var X=V(l({__name:"ArticleCardRecentlyEdited",props:{allowBanner:{type:Boolean,default:!0},allowTag:{type:Boolean,default:!0},allowTitle:{type:Boolean,default:!0}},setup:e=>(e,t)=>(s(),v("div",null,[u("div",{class:"card","shadow-box":""},[u("div",{pxsm:"",pysm:"","bg-hex-f6f8fa":""},[u("div",{class:"title","text-35":"","line-clamp-2":""},"福建一男子摄入卡路里结果卡路里"),u("div",{flex:"","justify-between":"","text-20":"","text-gray":"",mtxs:""},[u("div",{"flex-center":""},[u("div",{"i-ri-star-fill":"",mrxs:""}),u("div",null,"238"),u("div",{"i-ri-thumb-up-fill":"",mlsm:"",mrxs:""}),u("div",null,"1.5k+"),u("div",{"i-ri-brush-fill":"",mlsm:"",mrxs:""}),u("div",null,"24")]),u("div")])]),u("div",{psm:"",flex:"","justify-between":"","text-20":"","text-gray":"","bg-white":""},[u("div",null,"3 天前编辑    345字"),u("div",null,"继续编辑")])])]))}),[["__scopeId","data-v-1a9df2a9"]]);const Z={mounted(){let e=document.querySelector(".mescroll-body"),i=document.querySelector("#articles"),a=document.querySelector("#renderHelper");e.style.transition="transform 1s cubic-bezier(0,.63,.27,1)",i.style.transition="transform 1s",i.style.transform="translate(0,0)";let l={xAxis:0,yAxis:0};function s(t){t.xAxis&&(l=t),e.style.transformOrigin="center "+(document.documentElement.scrollTop+document.documentElement.clientHeight/2)+"px","true"==a.dataset.open?(e.style.transform="scale(0.9)",i.style.transform="translate("+5*+l.xAxis.toFixed(3)+"px,"+5*-l.yAxis.toFixed(3)+"px)"):(e.style.transform="scale(1)",i.style.transform="translate(0,0)")}t(s,"setValue"),new MutationObserver(s).observe(a,{attributes:!0})}};var ee=t((e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("renderBiz"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.renderBiz=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(Z)}),"block0");const te=l({__name:"Search",setup(e){var i;let a=C("searchInfo"),l=c(a,"value"),n=c(a,"searched");const o=h({get:()=>M.value&&!U.value&&l.value||n.value,set:e=>l.value=e});function L(e){return e*z.Global.navBarHeight+"px"}t(L,"navHpx");let A=p(30);var F=!1;x((({from:e})=>{if("backbutton"===e&&M.value)return M.value=!1,!0}));let q=m(!1),U=m(!1),D=m(!0),M=h({get:()=>q.value||U.value,set:()=>q.value=U.value=D.value=!1});function P(){return 1==D.value?D.value=!1:M.value?U.value?U.value=!1:l.value?l.value="":M.value=!1:D.value=!0}f((()=>U.value&&(q.value=!1))),g(M,(()=>D.value=!1)),t(P,"rightBtn");let R=m(0);null==(i=uni.onKeyboardHeightChange)||i.call(uni,(({height:e})=>{R.value=e,e&&(V.value=K.value)}));let V=m(p(1e3)),K=h((()=>{let e=z.Global.systemInfo.windowHeight-z.Global.systemInfo.statusBarHeight-R.value-p(50)||V.value;return e>V.value?V.value:e}));return(e,t)=>{const i=d,a=G,l=O,n=S,c=Q;return s(),v(T,null,[y(c,{class:"sticker",style:w({top:e.app.Global.systemInfo.statusBarHeight+"px"}),back:-e.app.Global.navBarHeight-e.app.Global.systemInfo.statusBarHeight-_(A)},{default:r((()=>[u("div",{style:w({height:e.app.Global.navBarHeight+"px",marginRight:-e.app.Global.capsuleMarginRight+"px",padding:_(F)?"":"20rpx 0 0 0",paddingRight:e.app.Global.capsuleWidth+"px"}),relative:"",flex:"",onTouchmove:t[8]||(t[8]=$((()=>{}),["stop","prevent"]))},[u("div",{"shadow-box":"",class:b(["menubar",{act:D.value}]),style:w({right:_(F)?"40rpx":"20rpx"})},[y(i,{onClick:t[0]||(t[0]=t=>e.app.to("#article/new"))},{default:r((()=>[y(i,{"i-ri-ball-pen-line":""}),k(" 新的创作 ")])),_:1}),y(i,null,{default:r((()=>[y(i,{"i-ri-qr-scan-2-line":""}),k(" 扫一扫 ")])),_:1})],6),u("div",{style:w({height:K.value+"px"}),relative:"",flex:"","flex-grow":"","flex-col":"","pointer-events-none":""},[u("div",{"shadow-box":"","pointer-events-auto":"",mxsm:"",pxsm:"","flex-center":"","justify-start":"",style:w({height:e.app.Global.navBarHeight+"px"}),class:b(["wave",{active:M.value}])},[u("div",{"flex-center":"",onLongpress:t[3]||(t[3]=t=>e.app.to("#test"))},[E(y(a,{style:w({height:L((_(F),.6)),width:L((_(F),.6))}),class:"smooth",src:"https://q2.qlogo.cn/headimg_dl?dst_uin=2490445193&spec=100&v=0.5662477152747005",onClick:t[1]||(t[1]=e=>U.value=!U.value)},null,8,["style"]),[[H,e.app.User.isLogin]]),E(u("div",{style:w({height:L((_(F),.6)),width:L((_(F),.6))}),class:"smooth login-btn","flex-center":"","text-20":"","font-bold":"","text-white":"",onClick:t[2]||(t[2]=t=>e.app.to("#user/login").then((t=>t&&e.app.toast(t))))}," 登录 ",4),[[H,!e.app.User.isLogin]])],32),u("div",{relative:"","h-full":"","flex-grow":"",mxsm:""},[y(l,{modelValue:_(o),"onUpdate:modelValue":t[4]||(t[4]=e=>I(o)?o.value=e:null),class:b(["ab",{hide:U.value}]),"auto-blur":"","h-full":"","w-full":"",placeholder:"搜索思潮",style:w({fontSize:L(_(F)?.35:.3)}),onFocus:t[5]||(t[5]=e=>{R.value=e.detail.height,q.value=!0})},null,8,["modelValue","class","style"]),u("div",{class:b(["ab",{hide:!U.value}]),"flex-center":"","bg-white":""},[u("div",{"flex-1":"",flex:"","flex-col":"","justify-center":""},[u("div",{flex:"","items-center":""},[u("span",{"text-38":"",mrxs:""},B(e.app.User.userInfo.username),1),u("span",{"text-20":"","text-gray":"","self-end":"",pb4:""},"#"+B(e.app.User.userInfo.id),1),u("div",{"flex-1":""}),j(" TODO: 上线前搞个内测徽章 "),j(" <div>徽章</div> ")]),u("div",{flex:"","items-center":"","text-24":"","text-gray-500":""},[u("div",{"i-ri-edit-2-fill":"",mrxs:"","shrink-0":""}),"$Default"==e.app.User.userInfo.signature?(s(),v("div",{key:0},"点此设置签名...")):(s(),v("div",{key:1,"line-clamp-1":"","break-all":""},B(e.app.User.userInfo.signature),1))])]),u("div",{style:{height:"60%"},"w-1px":"",mlsm:"",mrxs:"","bg-gray-200":""}),u("div",{"flex-center":"",mlsm:"",style:w({fontSize:L((_(F),.35))}),onClick:t[6]||(t[6]=t=>e.app.to("#user/setting").then((t=>t&&e.app.toast(t))))},[u("div",{"i-ri-settings-2-line":""})],4)],2)]),u("div",{"flex-center":"",style:w({fontSize:L((_(F),.5))})},[u("div",{"i-ri-close-fill":"",class:b(["x",{act:M.value||D.value}]),onClick:$(P,["prevent","stop"])},null,10,["onClick"])],4)],6),u("div",{"flex-grow":"",relative:"","pointer-events-none":""},[y(n,{"scroll-y":"",class:b(["ab history shadow-box",{hide:!q.value}]),onTouchend:t[7]||(t[7]=$((()=>{}),["prevent"]))},{default:r((()=>[j(" 搜索记录和推荐 "),u("div",{py30:""},"111111111111111111111"),u("div",{py30:""},"111111111111111111111"),u("div",{py30:""},"111111111111111111111"),u("div",{py30:""},"111111111111111111111"),u("div",{py30:""},"111111111111111111111"),u("div",{py30:""},"111111111111111111111")])),_:1},8,["class"]),u("div",{class:b(["ab profile",{hide:!U.value}])},[u("div",{class:"lay",flex:"",h600:"",mbsm:""},[u("div",{"shadow-box":"","h-full":"",w400:""},"TODO:个人卡片"),u("div",{class:"lay","h-full":"",psm:""},[u("div",null,"TODO:历史记录,个人收藏等私密信息")])]),u("div",{"shadow-box":"",mbsm:"",pylg:"","flex-center":"","justify-around":"","text-25":""},[j(" <div border border-dashed mbsm pylg flex-center justify-around> "),u("div",{"flex-center-col":""},[u("div",{w40:"",h40:"",mbxs:"","i-ri-chat-heart-line":""}),k(" 回复我的 ")]),u("div",{"flex-center-col":""},[u("div",{w40:"",h40:"",mbxs:"","i-ri-thumb-up-line":""}),k(" 收到的赞 ")]),u("div",{"flex-center-col":""},[u("div",{w40:"",h40:"",mbxs:"","i-ri-mail-line":""}),k(" 我的私信 ")]),u("div",{"flex-center-col":""},[u("div",{w40:"",h40:"",mbxs:"","i-ri-notification-4-line":""}),k(" 系统通知 ")])]),y(X),j(' <div flex-center class="rowFn">\n              <div\n                v-for="e in rowFn.map(e => e.split(\'|\'))"\n                flex-1\n                flex-center-col\n                pysm\n                class="wave click"\n              >\n                <div text-24>{{ e[0] }}</div>\n                <div text-22>123</div>\n              </div>\n            </div>\n            <div msm text-right text-20 text-gray fira>个人主页 -></div> '),j(' <scroll-view scroll-x enable-flex class="rowProj">\n              <div flex>\n                <div fira>&#xEE03;&#xEE04;&#xEE04;&#xEE04;&#xEE01;&#xEE02;</div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n                <div bg-green mxy p40></div>\n              </div>\n            </scroll-view> '),j(" <div absolute top-full left-0 right-0 text-18 ptxs flex-center text-gray-6 fira>\n              <div>2022-04-15 加入思潮</div>\n              <div flex-1></div>\n              <div>v0.0.34:65335</div>\n            </div> ")],2)])],4)],36)])),_:1},8,["style","back"]),u("div",{class:b(["mask",{show:M.value||D.value}]),onClick:t[9]||(t[9]=$((e=>M.value=!1),["stop"])),onTouchmove:t[10]||(t[10]=$((()=>{}),["stop","prevent"]))},null,34),u("div",{id:"renderHelper","data-open":M.value||D.value},null,8,["data-open"])],64)}}});"function"==typeof ee&&ee(te);var ie=V(te,[["__scopeId","data-v-55e8b370"]]);var ae=V(l({__name:"Fab",setup(e){let t=m(!1),i=m(0);return L(N((e=>i.value=e.scrollTop),100)),g(i,((e,i)=>t.value=e>i)),(e,i)=>(s(),v("div",{class:b(["fab",{hide:t.value}]),onClick:i[0]||(i[0]=t=>e.app.to("#article/new"))},[u("div",{"i-ri-add-fill":"",w57:"",h57:""})],2))}}),[["__scopeId","data-v-85eeac66"]]);const le=l({__name:"index",setup(e){let t=z.Data,i=c(t,"indexList");A(L).onLoad((e=>{})).onFetch((async e=>{let t={page:e.num,size:e.size,last_time:e.time};const{data:a,total:l}=await F.getProjectPage(t);0==e.num&&(i.value=[]),i.value=i.value.concat(a),e.endBySize(a.length,l,e.time)}));const a=q({value:"",searched:""});D("searchInfo",a);let l=h((()=>{const{navBarHeight:e}=z.Global,{statusBarHeight:t}=z.Global.systemInfo;return e+t+p(30)+"px"}));return(e,t)=>{const a=R,o=M(P("sys"),K);return s(),n(o,{top:l.value},{fixed:r((()=>[y(ie),y(ae)])),default:r((()=>[u("div",{id:"articles",ptsm:""},[(s(!0),v(T,null,U(i.value,(e=>(s(),n(a,{key:e.id,data:e},null,8,["data"])))),128))])])),_:1},8,["top"])}}});export{le as default};
